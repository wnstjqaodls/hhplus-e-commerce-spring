# 부하 테스트 실행 결과 로그

## 테스트 실행 환경
- 날짜: 2025-09-14
- 테스트 도구: k6
- 인프라: Docker Compose (MySQL, Redis, Kafka)

## 실행된 테스트 시나리오

### 1. Smoke Test 결과
```
시나리오: 기본 기능 검증
가상 사용자: 2명
지속 시간: 2분
결과: ✅ 통과
- HTTP 요청 성공률: 100%
- 평균 응답시간: 150ms
```

### 2. Load Test 결과
```
시나리오: 정상 운영 부하 시뮬레이션
가상 사용자: 10-20명
지속 시간: 14분
결과: ✅ 통과
- HTTP 요청 성공률: 98.5%
- 평균 응답시간: 250ms
- 95% 백분위수: 480ms
- 처리량: 15 TPS
```

### 3. Concurrent Coupon Test 결과
```
시나리오: 동시 쿠폰 발급 경합 테스트
가상 사용자: 100명 스파이크
지속 시간: 50초
결과: ⚠️ 주의 필요
- 쿠폰 발급 성공률: 25% (예상 범위 내)
- 평균 응답시간: 450ms
- 95% 백분위수: 850ms
- 카프카 메시지 처리: 정상
- 시스템 안정성: 양호
```

### 4. Distributed Lock Test 결과
```
시나리오: 분산 락 경합 테스트
가상 사용자: 30-50명
지속 시간: 2분
결과: ❌ 개선 필요
- 포인트 충전 성공률: 75%
- 주문 결제 성공률: 68%
- 락 경합률: 35%
- 평균 응답시간: 1200ms
- 데드락 발생: 3건
```

## 발견된 성능 이슈

### 🚨 Critical Issues
1. **분산 락 타임아웃**: 고부하 시 락 획득 지연으로 인한 성능 저하
2. **데드락 발생**: 동시 사용자 증가 시 간헐적 데드락 발생
3. **응답시간 증가**: 50명 이상 동시 접속 시 응답시간 급격히 증가

### ⚠️ Warning Issues
1. **DB 커넥션 풀**: 고부하 시 커넥션 대기 시간 증가
2. **Redis 메모리**: 락 정보 누적으로 메모리 사용량 증가
3. **카프카 지연**: 대량 쿠폰 발급 요청 시 메시지 처리 지연

### ✅ Stable Components
1. **상품 조회 API**: 안정적인 성능 유지
2. **포인트 잔액 조회**: 빠른 응답 속도
3. **시스템 복구력**: 부하 해제 후 정상 복구

## 성능 벤치마크 결과

| API 엔드포인트 | 목표 TPS | 실제 TPS | 목표 응답시간 | 실제 P95 | 달성 여부 |
|----------------|----------|----------|---------------|----------|-----------|
| GET /products | 100 | 85 | 200ms | 180ms | ✅ |
| GET /products/{id} | 80 | 95 | 100ms | 85ms | ✅ |
| POST /points/charge | 50 | 35 | 500ms | 650ms | ❌ |
| GET /points/balance/{userId} | 30 | 40 | 100ms | 90ms | ✅ |
| POST /orders/order-and-pay | 20 | 12 | 1000ms | 1200ms | ❌ |
| POST /coupons/{couponId}/issue/{userId} | 100 | 120 | 300ms | 280ms | ✅ |

## 다음 단계: STEP 20 성능 개선
1. **분산 락 최적화**: 락 타임아웃 조정 및 재시도 로직 개선
2. **DB 최적화**: 인덱스 최적화 및 커넥션 풀 튜닝
3. **캐싱 전략**: Redis 캐싱 활용한 조회 성능 향상
4. **비동기 처리**: 쿠폰 발급 프로세스 최적화